<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>再生産関係の推定</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>再生産関係の推定</h1>

<ul>
<li>AICで比較したあと、フィットした再生産関係のプロットなどをみて、ちゃんと推定できてそうか確かめて下さい</li>
<li><a href="https://ichimomo.github.io/future-rvpa/SRR-guidline.html">モデル診断</a>も行って下さい。</li>
<li><strong>設定ポイント:</strong> get.SRdata関数のyearsの引数で、再生産関係をフィットさせたい年を指定します。何も指定しないと全年のデータが使われます。</li>
<li><strong>設定ポイント:</strong> ここで、将来予測で使う再生産関係を一つに決めます(SRmodel.baseに入れる)。</li>
</ul>

<h2>データの作成</h2>

<ul>
<li>get.SRdataを使って再生産関係のフィット用のデータを作る</li>
<li>get.SRdata関数では，<code>rownames(res_vpa$naa)</code>を参照し、必要な年齢分のSSBをずらしたデータを作成する</li>
<li>yearは加入年</li>
</ul>

<pre><code class="r"># ライブラリとデータの読み出し
library(frasyr)
data(res_vpa)
# VPA結果を使って再生産データを作る
SRdata &lt;- get.SRdata(res_vpa)
head(SRdata)
#&gt; $year
#&gt;  [1] 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001
#&gt; [15] 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015
#&gt; [29] 2016 2017
#&gt; 
#&gt; $SSB
#&gt;  [1] 12199.02 15266.68 15072.03 19114.22 23544.42 28769.36 34764.44
#&gt;  [8] 38219.49 48535.10 61891.08 63966.56 38839.78 53404.29 47322.39
#&gt; [15] 54485.00 54385.04 47917.14 46090.77 59847.97 53370.62 48781.21
#&gt; [22] 42719.43 40095.37 39311.68 38335.80 37563.79 27601.75 23069.26
#&gt; [29] 22866.36 21728.52
#&gt; 
#&gt; $R
#&gt;  [1]  406.0086  498.9652  544.3007  469.6025 1106.8877 1043.4237  696.7049
#&gt;  [8]  923.9567 1353.1790 1698.8457 1117.5454 2381.1352 1669.1381 1818.3638
#&gt; [15] 1858.0043 1458.9524 1334.9288 1116.9433 1100.4598 1693.9770 1090.7180
#&gt; [22] 1081.8375 1265.0554 1024.0379  753.5039  764.9276  879.5034  512.4936
#&gt; [29]  583.0853  710.2242
</code></pre>

<pre><code class="r"># SSBとRのデータだけを持っている場合
SRdata0 &lt;- get.SRdata(R.dat=exp(rnorm(10)),SSB.dat=exp(rnorm(10)))
# 特定の期間のデータだけを使う場合
SRdata0 &lt;- get.SRdata(res_vpa,years=1990:2000) 
</code></pre>

<h2>モデルのフィット</h2>

<ul>
<li>HS,BH,RIをフィットし，再生産関係のパラメータを推定する</li>
<li>結果のオブジェクトのAICcにAICcの値が入っているので，それを比較し，再生産関係を決定する</li>
<li>SR.fitオプション

<ul>
<li>SR:再生産関係のタイプ： &ldquo;HS&quot;（ホッケー・スティック）、&quot;BH&quot;（べバートン・ホルト）、&quot;RI&quot;（リッカー）</li>
<li>AR: 自己相関の考慮なし(AR=1)、過去１年分の自己相関を考慮(AR=1)
（１年分しか対応していない）</li>
<li>method: 最小二乗法（&quot;L2&rdquo;)か最小絶対値法（&quot;L1&quot;）</li>
<li><strong>自己相関あり・なしでAICcを比較し、自己相関を入れたほうがいいかどうか判断する</strong>

<ul>
<li>\(\log(R_t)=\log(HS(SSB_t))+\rho \times {\log(R_{t-1})-\log(HS(SSB_{t-1}))}\)</li>
<li>\(\log(R_t)~N(\log(R_t),\sigma^2)\)</li>
</ul></li>
<li><strong>自己相関パラメータrhoの推定については不安定な部分があります。計算方法の改善により今後値が変わる可能性があります</strong></li>
<li>この例の場合はHSでARなしで最もAICcが小さい→MSY計算ではHS.par0の結果を使う</li>
</ul></li>
</ul>

<pre><code class="r">HS.par0 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
HS.par1 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
BH.par0 &lt;- fit.SR(SRdata,SR=&quot;BH&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
BH.par1 &lt;- fit.SR(SRdata,SR=&quot;BH&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
RI.par0 &lt;- fit.SR(SRdata,SR=&quot;RI&quot;,method=&quot;L2&quot;,AR=0,hessian=FALSE)
RI.par1 &lt;- fit.SR(SRdata,SR=&quot;RI&quot;,method=&quot;L2&quot;,AR=1,hessian=FALSE)
c(HS.par0$AICc,HS.par1$AICc,BH.par0$AICc,BH.par1$AICc,RI.par0$AICc,RI.par1$AICc)
#&gt; [1] 10.79385 13.40053 11.19098 13.86183 11.14223 13.80250
</code></pre>

<ul>
<li>結果の図示</li>
</ul>

<pre><code class="r">plot_SRdata(SRdata)
lines(HS.par0$pred,col=2,type=&quot;l&quot;,lwd=3)
lines(BH.par0$pred,col=3,type=&quot;l&quot;,lwd=3)    
lines(RI.par0$pred,col=4,type=&quot;l&quot;,lwd=3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="図：**観測値（○）に対する再生産関係式．plot=赤がHS，緑と青がBH, RIだが両者はほとんど重なっていて見えない**"/></p>

<ul>
<li>TMBオプション(<code>TMB=TRUE</code>)も使えます（<strong>ちょっと不安定です。使いたい場合はお問い合わせください</strong>）\
<a href="http://cse.fra.affrc.go.jp/ichimomo/fish/autoregressiveSR2.cpp">autoregressiveSR2.cpp</a>をダウンロードして，作業フォルダに置く</li>
</ul>

<pre><code class="r"># install.packages(&quot;TMB&quot;)　#TMBがインストールされてなければ
#library(TMB)
#compile(&quot;autoregressiveSR2.cpp&quot;)
#dyn.load(dynlib(&quot;autoregressiveSR2&quot;))
#HS.par11 &lt;- fit.SR(SRdata,SR=&quot;HS&quot;,method=&quot;L2&quot;,AR=1,TMB=TRUE) #marginal likelihood
</code></pre>

<h2>モデル診断</h2>

<p>再生産関係のあてはめのあとは、推定されたパラメータの信頼区間や頑健性などをチェックする必要があります。そのための関数群なども用意しています。詳しくは<a href=https://ichimomo.github.io/future-rvpa/SRR-guidline.html> SRRガイドライン </a> へ</p>

<h1>将来予測</h1>

<p>future.vpa関数を使います</p>

<ul>
<li>recfuncの引数に再生産関係の関数を，rec.argにrecfuncに対する引数（再生産関係のパラメータ）を入れる</li>
<li>利用可能な再生産関数

<ul>
<li>HS.recAR: ホッケー・スティック＋加入は対数正規分布＋自己相関ありの場合も対応</li>
<li>RI.recAR・BH.recAR：HS.recARのリッカー・べバートンホルトバージョン</li>
<li>HS.rec, BH.rec, RI.rec : 残差リサンプリング用</li>
<li>RPS.simple.rec : RPSのリサンプリング。旧ルールに対応</li>
</ul></li>
</ul>

<pre><code class="r">fres.HS &lt;- future.vpa(res_vpa,
                      multi=1, # res_vpa$Fc.at.ageに掛ける乗数
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      seed=1,
                      silent=TRUE,
                      recfunc=HS.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                   rho=HS.par0$pars$rho, # ここではrho=0なので指定しなくてもOK
                                   sd=HS.par0$pars$sd,resid=HS.par0$resid))
</code></pre>

<h2>将来予測で自己相関を考慮する場合</h2>

<pre><code class="r">fres.HS.AR &lt;- future.vpa(res_vpa,
                      multi=1,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,is.plot=FALSE, 
                      seed=1, silent=TRUE,recfunc=HS.recAR, 
                      # recfuncに対する引数 =&gt; 自己相関ありのオプションで計算した結果を入れる
                      rec.arg=list(a=HS.par1$pars$a,b=HS.par1$pars$b,
                                   rho=HS.par1$pars$rho, # 自己相関が高い場合、この値が&gt;0となる
                                   sd=HS.par1$pars$sd,
                                   resid=HS.par1$resid, # 再生産関係における残差の時系列
                                   resid.year=NULL # 近年の残差を何年分平均して将来予測に使うか？NULLの場合は、最後の年の残差を使う
                                   ) 
                      )
</code></pre>

<h2>Beverton-Holtを仮定する場合</h2>

<pre><code class="r">fres.BH &lt;- future.vpa(res_vpa,
                      multi=1,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      seed=1,
                      silent=TRUE,
                      recfunc=BH.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=BH.par0$pars$a,b=BH.par0$pars$b,rho=BH.par0$rho,
                                   sd=BH.par0$pars$sd,resid=BH.par0$resid))
</code></pre>

<p>同じ引数を使ってもう一度将来予測をする</p>

<ul>
<li><code>fres.HS$input</code>に、将来予測で使った引数が入っているので、それにdo.call(関数、引数)すると同じ計算を繰り返せる</li>
</ul>

<pre><code class="r">fres.HS2 &lt;- do.call(future.vpa,fres.HS$input)
</code></pre>

<ul>
<li>fres.HS$inputを上書きすることで，同じ引数を使いながら設定を少しだけ変更した将来予測が実行できる</li>
<li>引数<code>multi</code>がcurrent Fへの乗数になる</li>
<li>たとえばmulti=1からmulti=0.5に変更する例は以下のとおり</li>
</ul>

<pre><code class="r"># 引数をinput.tmpに代入．
input.tmp &lt;- fres.HS2$input
# 引数の一部を変える
input.tmp$multi &lt;- 0.5 # current Fの1/2で漁獲
fres.HS3 &lt;- do.call(future.vpa,input.tmp)
</code></pre>

<p>plot.futures関数を使って複数の結果を比較</p>

<pre><code class="r">par(mfrow=c(2,2))
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;SSB&quot;)
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;Catch&quot;)
#plot.futures(list(fres.HS,fres.HS3),legend.text=c(&quot;F=Fcurrent&quot;,&quot;F=0.5Fcurrent&quot;),target=&quot;Biomass&quot;) 
</code></pre>

<h2>旧ルールで使っていたRPSのリサンプリングによる将来予測</h2>

<pre><code class="r">byear &lt;- 2015:2017 # 生物パラメータを平均する期間を2009年から2011年とする
rps.year &lt;- 2001:2011
fout.rps &lt;- future.vpa(res_vpa,currentF=NULL, multi=1, 
                    nyear=15,start.year=2012,N=10000,ABC.year=2013, 
                    waa.year=byear,maa.year=byear,M.year=byear,
                    rec.new=NULL,is.plot=FALSE,
                    recfunc=RPS.simple.rec,
                    rec.arg=list(rps.year=rps.year,
                      upper.ssb=Inf,bias.corrected=TRUE,rpsmean=FALSE,
                      upper.recruit=Inf))
#&gt; rec.arg$rho is assumed to be 0...
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $MSE.options
#&gt; NULL
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $N
#&gt; [1] 10000
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 15
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$rps.year
#&gt;  [1] 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011
#&gt; 
#&gt; $rec.arg$upper.ssb
#&gt; [1] Inf
#&gt; 
#&gt; $rec.arg$bias.corrected
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$rpsmean
#&gt; [1] FALSE
#&gt; 
#&gt; $rec.arg$upper.recruit
#&gt; [1] Inf
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.arg = list(rps.year = NULL, upper.ssb = Inf, 
#&gt;     upper.recruit = Inf, sample.year = NULL, bias.correction = TRUE, 
#&gt;     rpsmean = FALSE), deterministic = FALSE, rec.resample = NULL) 
#&gt; {
#&gt;     if (is.null(rec.arg$bias.correction)) 
#&gt;         rec.arg$bias.correction &lt;- TRUE
#&gt;     if (is.null(rec.arg$rpsmean)) 
#&gt;         rec.arg$rpsmean &lt;- FALSE
#&gt;     if (is.null(rec.arg$rps.year)) 
#&gt;         rec.arg$rps.year &lt;- as.numeric(colnames(vpares$naa))
#&gt;     if (is.null(rec.arg$sample.year)) 
#&gt;         rec.arg$sample.year &lt;- rec.arg$rps.year
#&gt;     names(rec.arg)
#&gt;     if (is.null(rec.resample)) {
#&gt;         min.age &lt;- min(as.numeric(rownames(vpares$ssb)))
#&gt;         if (min.age == 0) 
#&gt;             slide.tmp &lt;- TRUE
#&gt;         else slide.tmp &lt;- -1:-min.age
#&gt;         rps.data &lt;- data.frame(year = years &lt;- as.numeric(names(colSums(vpares$ssb, 
#&gt;             na.rm = T))), ssb = SSB &lt;- as.numeric(colSums(vpares$ssb, 
#&gt;             na.rm = T)), recruit = rec &lt;- as.numeric(c(vpares$naa[1, 
#&gt;             slide.tmp], rep(NA, min.age))))
#&gt;         rps.data$rps &lt;- rps &lt;- rps.data$recruit/rps.data$ssb
#&gt;         rps.range &lt;- as.numeric(rps[years %in% rec.arg$rps.year])
#&gt;         rps.med &lt;- median(rps.range)
#&gt;         rps.mean &lt;- mean(rps.range)
#&gt;         rec.resample &lt;- as.numeric(rps[years %in% rec.arg$sample.year])
#&gt;     }
#&gt;     ssb.tmp &lt;- ifelse(ssb &gt; rec.arg$upper.ssb, rec.arg$upper.ssb, 
#&gt;         ssb)
#&gt;     rec_determine &lt;- ifelse(rec.arg$rpsmean, ssb.tmp * mean(rec.resample), 
#&gt;         ssb.tmp * median(rec.resample))
#&gt;     rec_random &lt;- sample(rec.resample, length(ssb.tmp) - 1, replace = TRUE) * 
#&gt;         ssb.tmp[-1]
#&gt;     if (rec.arg$bias.correction == TRUE) {
#&gt;         rec_random &lt;- rec_random * mean(rec.resample)/median(rec.resample)
#&gt;     }
#&gt;     rec &lt;- c(rec_determine, rec_random)
#&gt;     rec2 &lt;- ifelse(rec &gt; rec.arg$upper.recruit, rec.arg$upper.recruit, 
#&gt;         rec)
#&gt;     return(list(rec = rec2, rec.resample = rec.resample))
#&gt; }
#&gt; &lt;bytecode: 0x55a2563da4f0&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $seed
#&gt; NULL
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.catch.year
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
</code></pre>

<h2>残差リサンプリング</h2>

<ul>
<li>残差リサンプリングで将来予測をする場合→refuncとしてHS.rec（ホッケー・スティック）、BH.rec（べバートン・ホルト）、RI.rec（リッカー）を使う</li>
<li>rec.argの引数で、<strong>必ず</strong> resample=TRUEとしてください。</li>
<li>rho&gt;0の場合には対応しておりません</li>
</ul>

<pre><code class="r"># 残差リサンプリングによる将来予測
fres.HS4 &lt;- future.vpa(res_vpa,
                          multi=1,
                          nyear=50, # 将来予測の年数
                          start.year=2012, # 将来予測の開始年
                          N=100, # 確率的計算の繰り返し回数
                          ABC.year=2013, # ABCを計算する年
                          waa.year=2015:2017, # 生物パラメータの参照年
                          maa.year=2015:2017,
                          M.year=2015:2017,
                          is.plot=FALSE, # 結果をプロットするかどうか
                          seed=1,
                          recfunc=HS.recAR, # 再生産関係の関数（HS.rec=Hockey-stick)                                
                          rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                       rho=HS.par0$pars$rho,
                                       sd=HS.par0$pars$sd,bias.correction=TRUE,
                                       resample=TRUE,resid=HS.par0$resid))
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $MSE.options
#&gt; NULL
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.correction
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resample
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resid
#&gt;  [1]  0.14230780  0.12415307  0.22395093 -0.16125648  0.48770817
#&gt;  [6]  0.22824101 -0.36494355 -0.17739094 -0.03478592  0.13373274
#&gt; [11] -0.28508161  0.75317713  0.11609110  0.28599825  0.22328667
#&gt; [16] -0.01849768 -0.03555058 -0.17497213 -0.30048819  0.13086270
#&gt; [21] -0.25546420 -0.13094807  0.08889985 -0.10272350 -0.38436055
#&gt; [26] -0.34897012  0.09876784 -0.26192346 -0.12404380  0.12424438
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x55a25863b238&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $seed
#&gt; [1] 1
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.catch.year
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; Warning in rec0 * exp(rec.arg$rho * rec.arg$resid): 長いオブジェクトの長さ
#&gt; が短いオブジェクトの長さの倍数になっていません
</code></pre>

<p>残差リサンプリングか対数正規分布かの違いを比較</p>

<pre><code class="r">par(mfrow=c(2,2))
plot(fres.HS$vssb[,-1],fres.HS$naa[1,,-1],xlab=&quot;SSB&quot;,ylab=&quot;Recruits&quot;) 
plot(fres.HS4$vssb[,-1],fres.HS4$naa[1,,-1],xlab=&quot;SSB&quot;,ylab=&quot;Recruits&quot;) 
#plot.futures(list(fres.HS,fres.HS4)) # 両者の比較
</code></pre>

<h2>Fの設定とFrec</h2>

<p>将来予測における漁獲のシナリオ</p>

<ul>
<li>future.vpaの引数<code>ABC.year</code>で指定した年から，Fcurrent × multiによるFで漁獲される</li>
<li>ABC.year-1年まではFcurrentによる漁獲</li>
<li><em>Frecに引数を与えることで，任意の資源量に任意の確率で回復させるような将来予測ができます．</em></li>
</ul>

<p><strong>Frecのオプション</strong></p>

<table><thead>
<tr>
<th align="left">オプション</th>
<th align="left">説明</th>
</tr>
</thead><tbody>
<tr>
<td align="left">stochastic</td>
<td align="left">確率的将来予測をもとにFrecを計算するかどうか</td>
</tr>
<tr>
<td align="left">future.year</td>
<td align="left">条件を満たしているかどうかを判断する年</td>
</tr>
<tr>
<td align="left">Blimit</td>
<td align="left">条件として使われる閾値</td>
</tr>
<tr>
<td align="left">scenario</td>
<td align="left">=&ldquo;blimit&rdquo;: Blimitを<strong>下回る</strong>確率をtarget.probsにする</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">=&ldquo;catch.mean&rdquo;: future.year年の平均漁獲量をBlimitの値と一致させる</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">=&ldquo;ssb.mean&rdquo;: future.year年の平均親魚量をBlimitの値と一致させる</td>
</tr>
<tr>
<td align="left">target.probs</td>
<td align="left">scenario=&ldquo;blimit&quot;のときに目的とする確率（パーセントで指定）</td>
</tr>
<tr>
<td align="left">Frange</td>
<td align="left">探索するFの範囲．指定しない場合，c(0.01,multi*2)の範囲で探索しますので，うまく推定できない場合はfuture.vpaの引数multiを変えるか，このオプションでそれらしいFの値に限定してください</td>
</tr>
</tbody></table>

<pre><code class="r"># たとえば現状の資源量に維持するシナリオ
fres.currentSSB &lt;- future.vpa(res_vpa,
                      multi=0.8,
                      nyear=50, # 将来予測の年数
                      start.year=2012, # 将来予測の開始年
                      N=100, # 確率的計算の繰り返し回数
                      ABC.year=2013, # ABCを計算する年
                      waa.year=2015:2017, # 生物パラメータの参照年
                      maa.year=2015:2017,
                      M.year=2015:2017,seed=1,
                      is.plot=FALSE, # 結果をプロットするかどうか
                      Frec=list(stochastic=TRUE,future.year=2023,Blimit=rev(colSums(res_vpa$ssb))[1],scenario=&quot;blimit&quot;,target.probs=50),
                      recfunc=HS.recAR, # 再生産関係の関数
                      # recfuncに対する引数
                      rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                   rho=HS.par0$pars$rho,                                    
                                   sd=HS.par0$pars$sd,bias.corrected=TRUE))
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $Frec
#&gt; $Frec$stochastic
#&gt; [1] TRUE
#&gt; 
#&gt; $Frec$future.year
#&gt; [1] 2023
#&gt; 
#&gt; $Frec$Blimit
#&gt;     2017 
#&gt; 21728.52 
#&gt; 
#&gt; $Frec$scenario
#&gt; [1] &quot;blimit&quot;
#&gt; 
#&gt; $Frec$target.probs
#&gt; [1] 50
#&gt; 
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $MSE.options
#&gt; NULL
#&gt; 
#&gt; $multi
#&gt; [1] 0.8
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; NULL
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.corrected
#&gt; [1] TRUE
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; NULL
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x55a25863b238&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $seed
#&gt; [1] 1
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.catch.year
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; F multiplier= 1.20139
</code></pre>

<h2>年齢別体重が資源尾数に影響される場合</h2>

<ul>
<li><strong><em>future.vpaで，waa.fun = TRUEとすれば、年齢別資源重量が資源尾数（log(体重)~log(資源尾数)の回帰を関数内部で実行）の関数から予測されます</em></strong></li>
<li><strong><em>不確実性も考慮されます</em></strong></li>
<li>30系群であてはめた例は<a href="waa-lm.pdf">こちら</a> (データは1年分古いです)</li>
<li>太平洋マイワシ，対馬マイワシ，太平洋マサバ，ホッケ，瀬戸内サワラでは年齢別体重と年齢別資源尾数に関係がありそうなかんじです</li>
</ul>

<pre><code class="r">lm.res &lt;- plot_waa(res_vpa) # weight at ageが資源尾数の関数になっているかどうか，確認してみる．この例の場合は特に有意な関係はない
#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable

#&gt; Warning in summary.lm(lm.list[[i]]): essentially perfect fit: summary may
#&gt; be unreliable
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-11"/></p>

<pre><code class="r"># lm.resの中に回帰した結果が年齢分だけ入っています
fres.HS6 &lt;- fres.HS
fres.HS6$input$waa.fun &lt;- TRUE
fres.HS6$input$N &lt;- 1000
fres.HS6 &lt;- do.call(future.vpa, fres.HS6$input)
</code></pre>

<h2>その他のオプション</h2>

<ul>
<li><code>HCR=list(Blim=154500, Bban=49400,beta=1)</code> のように与えると、BlimからBbanまで直線的にFが減少するようなHCRで漁獲します。betaは、全体のFに掛ける乗数です。</li>
<li><code>pre.catch=list(year=2013,wcatch=13000)</code>のように与えると特定の年の漁獲量をwcatchで与えた漁獲量で固定します</li>
<li><code>rec.new=list(year=2012,rec=1500)</code>のように与えると、対応する年の加入を置き換えます。</li>
</ul>

<pre><code class="r">fres.HS5 &lt;- future.vpa(res_vpa,
                       multi=1,
                       nyear=50, # 将来予測の年数
                       start.year=2012, # 将来予測の開始年
                       N=100, # 確率的計算の繰り返し回数
                       ABC.year=2013, # ABCを計算する年
                       waa.year=2015:2017, # 生物パラメータの参照年
                       maa.year=2015:2017,
                       M.year=2015:2017,is.plot=FALSE,
                       recfunc=HS.recAR, 
                       rec.arg=list(a=HS.par0$pars$a,b=HS.par0$pars$b,
                                       rho=HS.par0$pars$rho,
                                       sd=HS.par0$pars$sd,bias.correction=TRUE,
                                    resample=TRUE,resid=HS.par0$resid),
                       rec.new=list(year=2012,rec=100),
                       pre.catch=list(year=2013,wcatch=100)
                       )
#&gt; $ABC.year
#&gt; [1] 2013
#&gt; 
#&gt; $add.year
#&gt; [1] 0
#&gt; 
#&gt; $Blim
#&gt; [1] 0
#&gt; 
#&gt; $currentF
#&gt; NULL
#&gt; 
#&gt; $delta
#&gt; NULL
#&gt; 
#&gt; $det.run
#&gt; [1] TRUE
#&gt; 
#&gt; $eaa0
#&gt; NULL
#&gt; 
#&gt; $faa0
#&gt; NULL
#&gt; 
#&gt; $Frec
#&gt; NULL
#&gt; 
#&gt; $futureF
#&gt; NULL
#&gt; 
#&gt; $HCR
#&gt; NULL
#&gt; 
#&gt; $is.plot
#&gt; [1] FALSE
#&gt; 
#&gt; $M
#&gt; NULL
#&gt; 
#&gt; $M.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $maa
#&gt; NULL
#&gt; 
#&gt; $maa.year
#&gt; [1] 2015 2016 2017
#&gt; 
#&gt; $MSE.options
#&gt; NULL
#&gt; 
#&gt; $multi
#&gt; [1] 1
#&gt; 
#&gt; $multi.year
#&gt; [1] 1
#&gt; 
#&gt; $N
#&gt; [1] 100
#&gt; 
#&gt; $naa0
#&gt; NULL
#&gt; 
#&gt; $nyear
#&gt; [1] 50
#&gt; 
#&gt; $outtype
#&gt; [1] &quot;FULL&quot;
#&gt; 
#&gt; $plus.group
#&gt; [1] TRUE
#&gt; 
#&gt; $Pope
#&gt; [1] TRUE
#&gt; 
#&gt; $pre.catch
#&gt; $pre.catch$year
#&gt; [1] 2013
#&gt; 
#&gt; $pre.catch$wcatch
#&gt; [1] 100
#&gt; 
#&gt; 
#&gt; $random.select
#&gt; NULL
#&gt; 
#&gt; $rec.arg
#&gt; $rec.arg$a
#&gt; [1] 0.02886733
#&gt; 
#&gt; $rec.arg$b
#&gt; [1] 51483.48
#&gt; 
#&gt; $rec.arg$rho
#&gt; [1] 0
#&gt; 
#&gt; $rec.arg$sd
#&gt; [1] 0.2580955
#&gt; 
#&gt; $rec.arg$bias.correction
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resample
#&gt; [1] TRUE
#&gt; 
#&gt; $rec.arg$resid
#&gt;  [1]  0.14230780  0.12415307  0.22395093 -0.16125648  0.48770817
#&gt;  [6]  0.22824101 -0.36494355 -0.17739094 -0.03478592  0.13373274
#&gt; [11] -0.28508161  0.75317713  0.11609110  0.28599825  0.22328667
#&gt; [16] -0.01849768 -0.03555058 -0.17497213 -0.30048819  0.13086270
#&gt; [21] -0.25546420 -0.13094807  0.08889985 -0.10272350 -0.38436055
#&gt; [26] -0.34897012  0.09876784 -0.26192346 -0.12404380  0.12424438
#&gt; 
#&gt; 
#&gt; $rec.new
#&gt; $rec.new$year
#&gt; [1] 2012
#&gt; 
#&gt; $rec.new$rec
#&gt; [1] 100
#&gt; 
#&gt; 
#&gt; $recfunc
#&gt; function (ssb, vpares, rec.resample = NULL, rec.arg = list(a = 1000, 
#&gt;     b = 1000, sd = 0.1, rho = 0, resid = 0)) 
#&gt; {
#&gt;     rec0 &lt;- ifelse(ssb &gt; rec.arg$b, rec.arg$a * rec.arg$b, rec.arg$a * 
#&gt;         ssb)
#&gt;     rec &lt;- rec0 * exp(rec.arg$rho * rec.arg$resid)
#&gt;     rec &lt;- rec * exp(rnorm(length(ssb), -0.5 * rec.arg$sd2^2, 
#&gt;         rec.arg$sd))
#&gt;     new.resid &lt;- log(rec/rec0) + 0.5 * rec.arg$sd2^2
#&gt;     return(list(rec = rec, rec.resample = new.resid))
#&gt; }
#&gt; &lt;bytecode: 0x55a25863b238&gt;
#&gt; &lt;environment: namespace:frasyr&gt;
#&gt; 
#&gt; $seed
#&gt; NULL
#&gt; 
#&gt; $silent
#&gt; [1] FALSE
#&gt; 
#&gt; $start.year
#&gt; [1] 2012
#&gt; 
#&gt; $use.MSE
#&gt; [1] FALSE
#&gt; 
#&gt; $waa
#&gt; NULL
#&gt; 
#&gt; $waa.catch
#&gt; NULL
#&gt; 
#&gt; $waa.catch.year
#&gt; NULL
#&gt; 
#&gt; $waa.fun
#&gt; [1] FALSE
#&gt; 
#&gt; $waa.year
#&gt; [1] 2015 2016 2017
#&gt; Warning in rec0 * exp(rec.arg$rho * rec.arg$resid): 長いオブジェクトの長さ
#&gt; が短いオブジェクトの長さの倍数になっていません
</code></pre>

<h1>再生産関係を仮定しない管理基準値の計算</h1>

<ul>
<li>ref.F関数を使います</li>
<li>%SPRやFmaxなど、再生産関係を仮定しない管理基準値を計算します</li>
<li>計算結果はres_brefに格納されます</li>
<li>YPR, SPR曲線とFcurrent (<code>res_vpa$Fc.at.age</code>に入っている値です), Fmax, Fmed, F0.1などの位置が表示されます</li>
</ul>

<pre><code class="r">byear &lt;- 2015:2017 # 生物パラメータを平均する期間を2009年から2011年とする
res_bref &lt;- ref.F(res_vpa, # VPAの計算結果
                  waa.year=byear, maa.year=byear, M.year=byear, 
                  rps.year=2000:2017, # Fmedを計算するときに用いるRPSの範囲
                  max.age=Inf, # SPR計算で仮定する年齢の最大値 
                  pSPR=c(10,20,30,35,40)) # F_%SPRを計算するときに，何パーセントのSPRを計算するか
#&gt; Estimate F%spr: initial value= 1.52  : estimated value= 1.520737 
#&gt; Estimate F%spr: initial value= 0.88  : estimated value= 0.8750482 
#&gt; Estimate F%spr: initial value= 0.58  : estimated value= 0.5872104 
#&gt; Estimate F%spr: initial value= 0.5  : estimated value= 0.4915332 
#&gt; Estimate F%spr: initial value= 0.42  : estimated value= 0.4141282
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAAFoCAMAAABNO5HnAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAAsSAAALEgHS3X78AAAcM0lEQVR4nO2dCXgURdrH4wIGATULZMnqKu6HgVWR7CJnkCQQAioYQDzgE8PlAnIFRDEghyDLIagcCyggiBGUgCBXuGQVCQJBDoncIC6QhAAhkAA5ZjLvTnfPTPqomqruqfRkmvo/T9JHVfV/5pdJT3UdbwUBlykK8vcLuFPEQZskDtokcdAmiYM2SRy0SeKgTRIHbZI4aJPEQZskDtokcdAmiYM2ScZBd3jKgCJCSTnq1zVyXY1qSpta/xB+h/2lHiPVLlfQ+Q7U2Rgjdlk9SDnWfWjkuhq5Xl2nAuH30CNMrulUiOGSJND2GU9WDapSb8wNTQoHrUsk0EPiv79ckps+SIuVg9YlEuiHi6XtPy6rUzhoXSKBjl4q3qB/rFuqTuGgdYkE+lzTB+K6PRP+6E+aFA5al8i1jmPrl6w5gDjPQesSr97pEq/eqRVwoBHVuy0pohq4j0/osPMK2pbpBDI3YfNOB2i+evXKOOiM9nVqN9kGtqDg4Hsitorb4NCEfCnR1OrdgmmiqrmPXz1Pb4cD/d9VhbAgpsdbxTCp47RpJTAvJrqjHY6fQd60aGQcdPgnpY6U6rm2oAtgS7n3krCF7NjhUqI/qncez0nb6O3QoFMjX5lT5Nr33Dqcvmv7RHcDyDVC2zDokj9kOX+fsouAIWKdtF0UK6X6o3rn8UyZTW+nBZ014Scokf0VtffoSa3il9A7uGT8E925yZcCaglww1TpEx01Vkr0R/XO43lkEL2dGrStzzNr7YozqC/D3MMAvWce1vPJxoGe3x+lVFnJkrlRwRGrRNAly2teswXdd3+NaiNd/3DlW71Dy+NZFEdfSA3acVSdA1fryF09cC448miNcKDP/4zSNWXh219W3yt8CVZr8qMI/FLIcVdK+YNuqjlT5tma3k4O2vF5FOIz6rV6l/Nc7NRLVEaGbx3nxU93h0+kW4frFjKuoyu1/EDnXJQUqkkp8+xI/TmTgy7oOqYQkYNQj7659jgc32EjGhkGfeLeNaWOnTUPK0DfqL1dSi0/0M3vqixKm6/M86191HZy0KgbP9UDy+/vtOxdQMhj/MtwW2TNWk3XggI0fNxI+r4uP9BJSdI2TJNS5rloGbWdB/S665gcdE+GZ0th0df5XjIE3JPhqU3Str4Xz12jqe3coMe/jvvvp34Ev/BR7DB8asCBpvG82pW6kAv0e/g/jZ62jmJwJHyB/tewJGgd1Q4X6LP4HDoblbLmxn2FOm9N0G1KaAuJoA96y2Gk9e7gC8vV92trgv4ndQOeAHrhQG85DDWTXvy43QXlGWuC/nAtbSEn6O3Pe60FG2+Pnv3SqtueA8OgZzVzPkU5Imeb3UyKl8xz82TaQk7QM3AVO0k+NPyfm/66Z98waHujJQDJEXazm0nxknleIPabuFX+PSzxPdcLDUDGbx27wm4UPLgbzG4mxUvuSV3tyGp8i5DD566sE+9/CY4SL41Kx1G/ZUoYkdTXH82kOMk9Y4opC6XUJeVg0md46umw9eI3AaqZ9B3Ub5lyQv98BSpiM6lTAzStnWhdf6obKQujztlmk09DTqGxWscg4YnTX82kWsk956ykK3N6vZm94OujujcxAjpxJACY3UyKl9xzx3jKQiYPNzjbqADSbvgO2oRmUrzknldeoClhm+uPcR2ftX/+eV9Bm9BMipfCk6ra8dFs/wygudzDKk+GAO1u47KV6fLTNj5SyVfPoYfIBdJ28iFhPnt+kkxXiIP20TPtHVw2j3YKvzhoHz3zO+KyufXri8JvDtpXzyhS9p5icz8H7avnCznec+d1ETcctK+eE7dTFeKgffVcN4OqkH9Aj36cybRnYeaz4RfECvTvPb1mHr9X2voHNEmOgzMuw54fKbqYDc0nEcUKNER7y1sU6RoBXTFBi/plVBSxDbcigG6HGrHo1hcfuXYqMGinnG9h5EvzfyNfVin0rDWVmIFO9DZa43v3pK6KDVrQxS9mAXx90vtly4SftaYSM9BLqKY/VHzQopb3ilzg7bJlwgclUIkZ6AOJ+KxlMxcCBLRTNrga9cKsTPRly4QPSqASM9BeJljkl728wAEtKDvlIByduOOm5rJlws9aU4kZaGiN/Ur4bJ5nN7BACyrePK5DhvqyZcLPWlOJHeg+p3A5u+Z6dgMPtFKtromSD6nEzVpTiR3ofyOHzwqSPQgEOujgl0T1V569fIxckh3ovW9RFAp00Jq2DnEy1ee9L14klWQHuhDzbeiQj9K1HOgmIaEhIdXvDiG2NrEDDVHoL960EbIDy4He/PjEYtg4hFzSeGAUjWdf9ONUovwL2XKgIX9QowMsQOMfMTWe85YjrzBZ/meyHmhnHfqJ9gxA4x8xNZ773iTbWRE0FI7+CHVaKQOBUXCe6G9D5fh+S4KmEoPAKB61RnwbOp5WHHLQOFEERvHodUS9/afhikMOGi9iYBSPFi3V5hr9H8UhB+1dBfIoMZ2lfsoqmlxHEBMI05Rz3ThonK6+0X5BaZ/KIRsoPEujiXYcNE7dR+0b/0SnghMPUXwZQtxN9ZmDqvo3B41TI4Dcmr8BxF5QpyA8R+9Un+l0RXnMQePUdkVBQt1MKGlQpE5BeH77gerEzXaqExw0Tr88dt/Akw37Nh1F45mjHhixaYrqBAeNl/OB5dLCzXSeLVXHBep5shw0G89XSO3fHDQbz49WKw6zUtQZOGg2nntHKg4XLlZn4KDZeJa0URy+ck6dgYNm5Bmn+PbroknnoBl5jv3eeyEOmpHn5ve9F+KgGXnekE+DG6zt1OWgWXm2LmtQtSOGsnLQrDwHH/bsHhiqTeagWXmu+LdndztiRhwHzcrzfHevhThoZp6RXgtx0Mw8+7rjlJ5BRXfmoJl5LnPPslnyGSKVg2bm6blJ90GNeeSg2Xm2dD2mfIoag8pBs/PsdxyTIIiDZueZPF/c3EKGK+Wg2XlmviJuxmmGHgjioBl6thJvzs8iZ0dz0Aw9BwjNHQ50kCUOmqHnaiEYTelGZBoHzdAz7zl8IQ6apWf0bYCT6JnhHDRLz3d3YNfA4aBZev6QBCVt0UkcNEvP4mj4GbMwGwfN1LPTlVxMBCgOmqnnnBW4FA6aqefZ15DP38BBs/ZsGY1JsCRoc+PeKZTQGZNgOdDmx71T6F3cw6HlQJsf906hTFzcbsuBNj/unVLxmPXoLQfaD3Hv5Fo1/3N0guVA+yHunUyZr1x8EZ1iOdB+iHsn06YpEIWOchzooKtIAQfIgaY1KhfQH6TCxE3IlEAHrXnTN8e/scfR948tiasIMIwSJitgh8P9kSmWA/1ai/cbTuj1y7THSCUZRglTqgXya9hyoB+4AmlVboDjL1mEkgyjhHlkE2J2D9uLSrIc6CdzoUhYY/Cv3iLvC2IYJcyjY8JtY8doVJLlQE99W9x8i+noKBPLKGFupcx2/rK1QiVZDrRdWlFp41lSSZZRwtyaKgas6puBSLIcaGoZiBI2UIqhHIwtIfXLpk5AJHHQXlV8VX6UdVbU/YRCJU8jTnLQOM1fAY6BlYLDd9N7lsyWtr0Q8QY5aJz+lg0b2p0rSX2U/sswwxX+bsMkbRoHjdMj12GJMHWwVTa159dzpW0RYg1rDhqnpG452V2K4Zt/0HvOSHPtJBzVpHHQONnH1I545LG/xJwx4Ll5rOYUB43XrYzUH/5ryNPWUtMaxUGz87SN8+wO3qNO5KAFkbq96DxP9fPspmlG4N3ZoPOHx44rBtjeiInnhumeXUczmyrxzgad0G5R1NvHO9amWBKAwjN5W9n+6K2qxDsbdO0cyK4WMi6fmFm358lXVSfubNBC81ANzEAMHz2j85THHDSpiYjeU7H4y/xFysQ7HPSFCxfuc/5oYnEb8cyXxwmD66q1We4U0NoKnAA6yC0WnvtHKA5fPqE4tDpofAVOgGtzi4XnzpWKw9R3FYdWB42vwImf4kvrUq8x95RU2kIxD87qoPEVOAH01nsjGtbStuz76OnSe+vkR1YHja/ACaAjUgCWN2Xk2Ut1fEEx+P9OAI2uwAmg77EDlFRj4+mIVp+J/112YHnQ2Aqcux4N+E5tXZ6ZmgCD696zBVVy6glIfbR6667iOdvbd13RFHVlD2jQ+Aqcux59IZhNPfq3T9VnbC0Lg8Qr59XcVjLwYfFc5wmVrAkaX4FjXo/WavLXEuiVHQBOVBIXzjkEFgWNr8Axr0drdbmDBHryUOc9uuop6aRFQeMrcOKnONf5bfjTgsOodL2eg3K153oGhdapU6fnmLedoKsflM5ZFDS+AieA3lLtNHxVvUPN9Qw8YxDdNLuDDmZnZ+f9a4AT9N3W/kTjK3AC6MarABouh/80Z+CJmmBoC/pV2KyOdt6cK7mGAVsUNL4CJ4Cu5fykBReBo5bvno7JiJO2oCRhk/+nbcW9H3H+awlPTlYFja3ACaDrlEJyNIC9JlPPMtmCGouf4x3h1WNfcNrtuhocHBQcjO5qCGzQ3uvRcZ9mNZ4LsAo1/NO4p1zTv3DtWP3J0Hs9OiP8D51LIPXebdqCej3noK9x42nXUBqrg55tx6VIn3GhKfP8CVweHZ6DUcP8nUrcIW2tDjry77i5yu6bSf6BdJ1N0kjPZzFv7Lyrg8vqoB3JD/ZFf827QC+NeLl7E/W6pQY8sUNDEvaLG6uDBihI+vOwkSNHas4LoNMBOgr3lljGnnIdf0ncWB/09RGhgxITEzXnBdDP9s99q/fceYkv++6Jjt8oqJv40GJ10I4lYQk5yBTx1vFN40+/m/XhRt8blX5EPa9ISu8l/LY66GaN0jAp0j361pjW+1l4LsHEQxH0vFCrsTroWd6rd7bMyyefG4Bod9PrOf4HfP6fe4H1QeMlgJ7TuG3rRqlrnlpEzE3yXH0VcdIt4SONAu3u6ZJkZdDC6gcFcXD7XVJm3zzTE3Cg5U0wAQiaOsBglw/XpLw5iIWn97fV9VdvoA9HJEU+9kPnh1oBLKv/1+jzMDMeIG6e3pflUoUMMHhj4dujV+mrcqA8AUrbey2R0c0b6IxKu6FHw8JVwVm5Vc9C/wFgb7z1W3R4FQpZO8BgJuGrLuEnNGixpyujNsDYN2Bd7YOQD7AiDuBAw78RQxXhZO0Ag3uSvBc5F4cGLfZ0ZdQFmDAS1v1pf+m4Zs3ChcfUSMTcW0oFZIBB6uBVp3cRrjTsSy+3jrpu0Csa5kGyE/TGqGboRUYoFHABBg0Hr0LqWlPESqka0HM7wbXY5nCz3pH0R24acBFUTqDvbidK/nFhFGBQV/CqPO0plcYhuuI1oC83D2+zN2zMyESAfsOJl0TL7Hr0dVJJpsGr4omfv//WJr2iAKtHO5KHfCBM4K5BKsk0eFU0yQ2yWo0i5Agw0KMajOlbcyID0LqCVxErk856dAdCj1mAgX7oKkB2fK8S4qw2A8GrtqSIQvwNV2pPqZTV46iXlbQEBRjoRkLrTumIuFBSSap69GVFdKQF00TpHrkuyFmPHuZ95FmAgZ4mxWAdTuRIypBz0anPe1+8SPaEAvK7coLOa37LW44AA+2QHh0cmmHhapFANwkJDQmpfneIFqv2zLxVJDexrWP5O95yBBhoapFAb358YjFsHIJI0XqOQsZ9VUh8BI8/5CXHnQoa8gc1OkAJujsptK8L9Om2XhoGdINW9hu4hQS9VOeltSrXUD8/PtGeDvRGcpum1Kg0dQ4+hwHQqLk3MULnnV0J2lFH56W1Kt+YSoWjUeNiDHlKoG3R2qBjbhkGvbrBgz2L9jQAcP4ciKgTcyDi1Rho9kSDZ7PgcMS7UeFboMtdT5w38qJlqhjBq86RC7maSY90wPb+GAWdGXrO3mmqC/SR6o87f76G7Cr7YGZXyKi0Gb6KhCu6p/hpVCFAX3mJXMjdHv3eJ7gcBkCL/QafxwPccn+iM+6Jdv6UwrLQAiiobM+4D+CXhy0D+uAIVDal3KBtbU5hchgALfYbfJAgHLhBPxDj/AGYUenhunVDsjMeBHD+WAX0hpnkQp4eluOxmKEmRm8dnz8LcO18en2AbU7QD8YIZCE5TPwytBjosxQDrMu6sj7+FzqHUdAX7z9qf3FqZo086F8G+tLdhyF9qBv09UpGuxE8qhCgaVQG2tEZ3ftjuNaxMjysZxGMrN9+9qMe0M5aR72/73KDhrha+4y8aJkqBOjTFONIZJ2zOZHIsRB37JMhveczpKVIQDlSKVUdFE8UB030JDf7q4aEjULV8Thooqdu0La4n7U5OGii5/cUhZQDaDJbaicocdBMPFUjldKe09SmOWiS5zVtJ4xW6iFhs8aoc3DQJM/kxRSFNGPvEtQduhw0yXPKFopCGtCFbVTdMhw0yRM3O1kh7WjS7GbKNmIfQbv7W1CgD9Xz6dKCKgLofcUUhRDDdg9HKQJM+gxaeiC3MGgqocZH74iXzzZgA/pwDXGexuOPFMDGJ4VOFpjyUMRka4A+SFMIOf1t8euyVhI2oDPuEudp3K58OjskQ+hkORaS7XjVEqBL29AUQs8znChbNtVn0NI8jSriPA2onrbsGRA6WRbEA2yxBOhsqpnkmAmdI8r6DHwGLc3TqCoOtoYaO2dUryt0svyrF0C6JUAf0k7oRwgDurTnEvcuo1uHB3SyFO13vnOzwRKgb1AFsMFNUbb3WO7aYw36UugpoZPl8B+z7N0sAZpO2LngxfGrpR3WoJ21DqGTBcaFNfi4rk+XFlQBQJ8kzh0VhJ90X9R5hbjlT4YEz0RvIxc98hLdoLBTirDhoAmeL2vWSkXJWxiJwi5CdDwOmuDZFhsSRC6v8TpKui/goImeVA+GhMAo9n6TOGg2noQINI6kId9y0F49bZpVT5EihvqZ1WqawdejlGVBn+lDVYgcUykpHBfwWJcsCzptNCabUhTBq4a20C4nrl+WBf3NLKpCNFHCzrXabOwVyWVZ0JepqtF04djyX5hOEw7KqywLmlJ0ce8c73X3FZBlQe/GRyWVizbA4IbI40ZeU5ksC7oj3RrM1JEcz0YtJ2T0rgoZ946FJ2pZEIToQ2YWDUvwZXx+hYx7RxJN8KpoiuuAvtika1rRPdYjFXBx72iDV50kGUnSFQT2QocPjMYXDLy4d7qCV5GlL9pu6Yy4s0ZcIADj3lEGr8qjnIWjN6zx0ei5xj7UARf3jjJ41XcTSUaSdMePtk2Jo7wrKRVwce8og1etWEDxKsFQoO5j7SbT1dEVCsB6NO4vpvCcs5rOzkhEdMenrb6nu7pMZoMmLkJNW4+WxQXs/JSoKvLkS5RvyFjo+Zxer2XSXd8js0CLMaec8jlKGD5SoQm1jjLtippapMvILNDN76osyucoYfhIhQrPzZTNbYYXUyhd2CJFT5OeWaCTXJGcw0glSaDxkQoVntHlDRrgRlIsbo0ThMwCfWqTtK1PKkkCjY9UqPCkbOrwbXmQC3260kzfEBVwtQ58pEKFJ82sWUE+rsPya7eeuIAqKgUcaHykQoXnb5R2Pi94sz++FxXqgAPN2JPBykL7uvT8lWxkUdBXiI/6LjFZwunQK12IfhYFvRW/6ptSjNbKOtU/dq33xiaLgk5eSFmI2aJkOeNbzPLWe2ZR0LPWUhZiuPpb4eKoIfgeXIuCzqWI8iOK7TJ7u3p0WImZr2tR0NRivZ7hpWkt3zqGSrAo6G9omyHYLxzp2PH/bRde15y2KOgo/4F2Km9B2x7qBXOtCpq2UHkthXpqQss3dsorfBYFTTUPXFA5rjmb/maL4bs9rC0Kmm4oKZTz4r6OtBEtB38n3UMsCppa5b2KsiM9KbJnSr5VQV/6gbaQGctVn5rR/plZzaV9i4FOnUpbyKR1wa99HRY5eH2+5UAv+4y2kHkLsDsOTImLndiKvMSiLvkZ9Efel7+SydyV7m+m/l9kpxn7qeb00snPoPNoAoSJMhe0cOu4umZY605T0/QNVsCK1zrUUtQ6rq0f1bbtqHU5vl/Wz6BTqP85/QNaUOGu6V1avTp7j28fbT+DbhMAoEX9vnJk2+iBiw8ZGDUpyc+go6kL+Rm0IHvG0iFtovt/stfrsooY+Rl0W+pCFQC0KPvR5W93aP3y5G/P6ps66u9aB3WhigJaUuaWD16Linr9w62o9eOQ4rUOtejbOuwnv5ncPSqq97S1x8m3bv+Cvr6BulAFBC3JfmbTzP7tWnccMX/7OS8DGfwL+uc3qQtVWNAu3fj5q0mvxUR1Spyz8Riqw9m/oLdilr1CqKKDdunGwdXTB7SPbtNz7OLtp+Q1b/+CXklcq9mjAAHtUumFH7+Y1C8uJsYTjMS/oItoR3UEGmiPPB9qXutQy5I9LGsCtR6tX/4F3YN+bhoH7Ytne8vfoz3yL+hY+kIctC+edFF+RHHQJnly0D542pbSF+KgffDM6k5fiIP2wTNjMH0hDtoHz7QJ9IU4aB88S3V0vnHQJnly0N5ECDC4nXYiOFgUNJOQmRQBBt9Kp/BxyXKgmYXMpAgw2EdHEEDLgWYWMhMRYHDgS6KC3ccvaiefYRXooIOl9z7Ic4JZyExEgMGss6Jauo/1jGYLdNAtpPd+yXOCWchMfIBB2qAzCgU6aM2bZhYyEx9gkIOWxChkpi5PsiwImlIctJHLGhAHbeSyBsRBG7msAXHQRi5rQBy0kcsaEAdt5LIGZBz00KdcqqZD99wtO6iMylE1mHiRYHKWalUUG2+GVHK/V6pV5hmD9qijwYVpbnY0aLh0qcGCpr9SmThoCnHQOsVB6xMHrU8ctE5x0DRiALq3wXnsRb0NGq6mXPRFI9NfqUwMQHPRiIM2SRy0SeKgTRIHbZI4aJPEQZskDtokcdAmyRfQv8c8PNSu2tNZcFiTJk2m0Bc8Pbp5jvoS+srpM3RMi3joHYcBQ618Ad10SdHzM1V7Ogu2XHnmDGl4oEybku66qL6EvnL6DHf1v3qlQbIBQ618AH38AQd8/6RyT2dBaEC5mJtHlS+qL6GrnH5DGDPEkKFaPoBeHwdwuapyT2dBCJ38z8W6/iFdwHQ6loHWbQj9phsyVMsH0Eu6AZQE5Sv2dBaEsVt2NqWPyAQeYDody0DrNrxU63dDhmr5AHrNMwC5VRyKPZ0FBe2po8fUBUynYxlovYalnd8zZqiWD6APhAPsr6fc01lQ0HHtcrZe5AKm01EBWpfhmwlgzFAtX2odj+6CwaMBFuW493QX3PwdQGI3PZ4iMP2O7nJ6DUe0E4MOGjBUyxfQu+s2jroOt4JXuvb0FzwZFR7eOou+YP2woNCmBhw95XQafhoUen+NGtcNvEWNfHoyLBWfAq579gwUvKWjFu2RAUdPOVMNZeKP4CaJgzZJHLRJ4qBNEgdtkjhok8RBmyQO2iRx0CaJgzZJHLRJ4qBNEgdtkjhok8RBmyQO2iRx0CaJgzZJHLRJ4qBNEgdtkgIH9OGIpMjHfuj8+CCAZfX/Gn0eZsYDxM3z98uiVeCAzqi0G3o0LLxdIyu36lnoPwDsjbd+24IUqbLCKIBA1wYY+wbAoweFhV9WxAEcaPi3I/5+VdQKINB1ASaMBGiwv3Rcs2bhwnJGka39/aLoFYigVzTMg2Qn6I1RzTb6+1VRKxBBz+0E12Kbw816R9IfMRgYwnwFIujLzcPb7A0bMzIRoN9wf78sWgUO6AAXB22SOGiT9D/scrbxB9AgTwAAAABJRU5ErkJggg==" alt="図：YPR, SPR曲線"/></p>

<ul>
<li>結果のサマリーは<code>res_bref$summary</code>によって見れます</li>
<li>max: F at ageの最大値，mean: F at ageの平均値，Fref/Fcur: Fcurrentを分母にしたときのF管理基準値の比</li>
<li>この結果から，現状のF（Fcurrent）はFmedとほぼ同等（Fref/Fcur=0.96なので），F％SRP=10％くらいであることがわかります</li>
</ul>

<pre><code class="r">res_bref$summary
#&gt;           Fcurrent     Fmed     Flow     Fhigh      Fmax      F0.1
#&gt; max       1.313100 1.376518 1.622459 1.1151329 0.6917857 0.3936176
#&gt; mean      1.066667 1.118183 1.317967 0.9058526 0.5619563 0.3197463
#&gt; Fref/Fcur 1.000000 1.048296 1.235594 0.8492367 0.5268339 0.2997621
#&gt;              Fmean FpSPR.10.SPR FpSPR.20.SPR FpSPR.30.SPR FpSPR.35.SPR
#&gt; max       1.407719     1.520737    0.8750482    0.5872104    0.4915332
#&gt; mean      1.143528     1.235336    0.7108253    0.4770069    0.3992857
#&gt; Fref/Fcur 1.072057     1.158127    0.6663986    0.4471939    0.3743303
#&gt;           FpSPR.40.SPR
#&gt; max          0.4141282
#&gt; mean         0.3364075
#&gt; Fref/Fcur    0.3153820
</code></pre>

<pre><code class="r"># 横軸や縦線で示す管理基準値を調整する場合、plot_Fref関数を使う
# x.labelは res_bref$summaryの行名、vline.textは res_bref$summaryの列名前に対応させて指定する
plot_Fref(res_bref,xlabel=&quot;Fref/Fcur&quot;, vline.text=c(&quot;FpSPR.20.SPR&quot;,&quot;FpSPR.30.SPR&quot;,&quot;FpSPR.40.SPR&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="図：YPR, SPR曲線 (x軸などを変更した場合)"/></p>

</body>

</html>
